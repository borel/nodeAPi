<html>
    <head>
        <title>Smoozi Tracker</title>
    </head>
    <body>

        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBmhelMVEXev83EyFPJhCJ1fYnQleKPfos&sensor=true"></script>
        <script type="text/javascript" src="/socket.io/socket.io.js"></script>
        <script type="text/javascript" src="./jquery.min.js"></script>
        <script type="text/javascript" src="./marathon.js"></script>

    	<script type="text/javascript">
            ////////////////////////////////////////////////////////////////////
            ////////////// GMAPS ///////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////
            var map = null;

            function mapInitialize() {
                map = new google.maps.Map(document.getElementById("map-canvas"), {
                    zoom: 12,
                    center: new google.maps.LatLng(40.742494, -73.953867)
                });
                infowindow = new google.maps.InfoWindow({ content: 'Test' });
                google.maps.event.addListener(map, 'click', function() {
                    infowindow.close(map);
                });

                nycMarathonInitialize();
            }


            function nycMarathonInitialize(){
                var nycMarathon = new google.maps.Polyline({
                path: nycMarathonCoordinates,
                geodesic: true,
                strokeColor: '#FF0000',
                strokeOpacity: 1.0,
                strokeWeight: 2
              });

                nycMarathon.setMap(map);
            }


            function addMarker(user,lat,long){
                var marker = new google.maps.Marker({ map:map });
                google.maps.event.addListener(marker, 'click', function() {
                            infowindow.setContent(marker.getTitle());
                            infowindow.open(map, marker);
                });

                //Move the markers
                marker.setPosition(new google.maps.LatLng(lat, long));
                if(user === 'lj'){
                  marker.setIcon('./img/LJ.png')
                }else{
                  marker.setIcon('./img/ML.png')
                }
            }


            ////////////////////////////////////////////////////////////////////
            ////////////// /GMAPS ///////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////

            ////////////////////////////////////////////////////////////////////
            ////////////// Chat ///////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////

            ////////////////////////////////////////////////////////////////////
            ////////////// /Chat ///////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////


            ////////////////////////////////////////////////////////////////////
            ////////////// Socket///////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////
            var socket = io.connect('/');

            socket.on('message', function(data) {
                addMarker(data.user,data.lat,data.long);
            })
            ////////////////////////////////////////////////////////////////////
            ////////////// /Socket///////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////

            ////////////////////////////////////////////////////////////////////
            ////////////// Common ///////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////
            google.maps.event.addDomListener(window, 'load', mapInitialize);
            ////////////////////////////////////////////////////////////////////
            ////////////// /Common///////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////


    	</script>

        <style>
            #map-canvas  { height: 80%; width:80%}
            #user-number { font-size: 15px; font-weight: bold; font-color:black;}
        </style>

        <p> Welcome to NYC marathon tracker</p>
        <div id="map-canvas"></div>

    </body>
</html>
